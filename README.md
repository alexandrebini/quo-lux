# README

### Demo
- https://quo-lux.herokuapp.com/
- user: quo-lux@mailinator.com
- passwd: 1234567


### Models
- `User`: basic login, generated by devise. 
- `Product`: stores the product info. As I want to avoid scrapping the same product over and over again, multiple groups can use the same product.
- `Group`: The competitors monitor `group`.
- `Competitor`: Relates `group` with `product`.


### Tracking
- For scrapping product attributes I'm using Watir. It's really easy to add new attributes. Examples here: https://github.com/alexandrebini/quo-lux/tree/master/lib/amazon.
- There are some control attributes on Product:
  * `status`: stores the current status of the product. `pending` when the product is created and needs to be fetched, `fetching` when the fetch job is running and `ready` when the product has all required attributes (title price rank reviews_count)
  * `last_fetched_at`: stores the last time that the product was fetched 
  * `last_fetch_status`: store the last fetch status 
  * `last_fetch_log`: store the last fetch log, useful for errors
- I assumed that when an attribute comes empty from amazon, it should not replace what is already saved
- Using papertrail for versioning


### Notifications
- We deliver a daily digest notification, with all product that changed after `yesterday at 00:00:00` (configurable via `secrets.yml`) 
- I'm using an mailgun sandbox. Emails are just sent to `quo-lux@mailinator.com`. See the inbox [here](https://www.mailinator.com/v2/inbox.jsp?query=quo-lux)


### Tasks
- `rails products:fetch`: Fetch all products and delivers notifications.
- `rails notifications:deliver`: Notifies users for changes happened on monitored competirors.
